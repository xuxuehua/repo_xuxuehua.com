<!DOCTYPE HTML>
<html>
  <head>
    <link rel="Stylesheet" type="text/css" href="/static/css/style.css">
    <link rel="Stylesheet" type="text/css" href="/static/css/tango.css">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="alternate" type="application/atom+xml" href="atom.xml" title="Atom feed">
    <title>variables 变量 - Xu XueHua</title>
    <meta name="keywords" content="Xu XueHua"/>
    <meta name="description" content="Xu XueHua's public notes"/>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  </head>

  <body>
    <div id="container">
      
<div id="header">
  <div class="post-nav"><a href="/">Home</a>&nbsp;&#187;&nbsp;<a href="/#Shell">Shell</a>&nbsp;&#187;&nbsp;variables 变量
    <span class="updated">Page Updated&nbsp;
      2020-03-22 19:48
    </span></div>
</div>
<div class="clearfix"></div>

<div class="page_title">variables 变量</div>

  <p>[toc]</p>
<h1 id="_1">变量</h1>
<p>变量可被设置为当前shell的局部变量，或是环境变量。如果您的shell脚本不需要调用其他脚本，其中的变量通常设置为脚本内的局部变量</p>
<p>变量定义中“=”前后不能有空格，命名规则就和其它语言一样了</p>
<h2 id="_2">局部变量</h2>
<p>默认变量是全局的，在函数中变量local指定为局部变量，避免污染其他作用域。</p>
<h2 id="_3">获取变量</h2>
<p>要获取变量的值，在美元符后跟变量名即可。shell会对双引号内的美元符后的变量执行变量扩展，单引号中的美元符则不会被执行变量扩展。</p>
<div class="hlcode"><pre><span class="n">name</span><span class="o">=</span><span class="s">&quot;John Doe&quot;</span> <span class="n">or</span> <span class="n">declare</span> <span class="n">name</span><span class="o">=</span><span class="s">&quot;John Doe&quot;</span>   <span class="err">#</span> <span class="n">local</span> <span class="n">variable</span>
</pre></div>


<h2 id="_4">全局变量</h2>
<p>使用export提升变量为全局</p>
<div class="hlcode"><pre><span class="n">export</span> <span class="n">NAME</span><span class="o">=</span><span class="s">&quot;John Doe&quot;</span>    <span class="err">#</span> <span class="n">global</span> <span class="n">variable</span>
</pre></div>


<div class="hlcode"><pre><span class="n">echo</span> <span class="s">&quot;$name&quot;</span> <span class="s">&quot;$NAME&quot;</span>      <span class="err">#</span> <span class="n">extract</span> <span class="n">the</span> <span class="n">value</span>
</pre></div>


<h2 id="readonly">只读变量 readonly</h2>
<div class="hlcode"><pre><span class="err">$</span> <span class="n">readonly</span> <span class="n">x</span><span class="o">=</span><span class="mi">1</span>

<span class="err">$</span> <span class="n">echo</span> <span class="err">$</span><span class="n">x</span>
<span class="mi">1</span>

<span class="err">$</span> <span class="n">x</span><span class="o">=</span><span class="mi">2</span>
<span class="o">-</span><span class="n">su</span><span class="o">:</span> <span class="n">x</span><span class="o">:</span> <span class="n">readonly</span> <span class="n">variable</span>

<span class="err">$</span> <span class="n">unset</span> <span class="n">x</span>
<span class="o">-</span><span class="n">su</span><span class="o">:</span> <span class="n">unset</span><span class="o">:</span> <span class="n">x</span><span class="o">:</span> <span class="n">cannot</span> <span class="n">unset</span><span class="o">:</span> <span class="n">readonly</span> <span class="n">variable</span>
</pre></div>


<h1 id="internal_variables">internal_variables</h1>
<h2 id="random">RANDOM 随机数</h2>
<p>随机字符串</p>
<div class="hlcode"><pre><span class="cp"># echo $RANDOM | md5sum | cut -c 1-8</span>
<span class="mo">024</span><span class="n">cbfdc</span>
</pre></div>


<p>随机数字</p>
<div class="hlcode"><pre><span class="cp"># echo $RANDOM | cksum | cut -c 1-8</span>
<span class="mi">20613431</span>
</pre></div>


<h2 id="histtimeformat">HISTTIMEFORMAT 历史命令格式</h2>
<div class="hlcode"><pre><span class="err">$</span> <span class="n">export</span> <span class="n">HISTTIMEFORMAT</span><span class="o">=</span><span class="err">&#39;</span><span class="o">%</span><span class="n">F</span> <span class="o">%</span><span class="n">T</span>  <span class="err">&#39;</span>

      <span class="mi">1</span>  <span class="mi">2013</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mi">09</span> <span class="mi">10</span><span class="o">:</span><span class="mi">40</span><span class="o">:</span><span class="mi">12</span>   <span class="n">cat</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">issue</span>
      <span class="mi">2</span>  <span class="mi">2013</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mi">09</span> <span class="mi">10</span><span class="o">:</span><span class="mi">40</span><span class="o">:</span><span class="mi">12</span>   <span class="n">clear</span>
      <span class="mi">3</span>  <span class="mi">2013</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mi">09</span> <span class="mi">10</span><span class="o">:</span><span class="mi">40</span><span class="o">:</span><span class="mi">12</span>   <span class="n">find</span> <span class="o">/</span><span class="n">etc</span> <span class="o">-</span><span class="n">name</span> <span class="o">*</span><span class="p">.</span><span class="n">conf</span>
      <span class="mi">4</span>  <span class="mi">2013</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mi">09</span> <span class="mi">10</span><span class="o">:</span><span class="mi">40</span><span class="o">:</span><span class="mi">12</span>   <span class="n">clear</span>
      <span class="mi">5</span>  <span class="mi">2013</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mi">09</span> <span class="mi">10</span><span class="o">:</span><span class="mi">40</span><span class="o">:</span><span class="mi">12</span>   <span class="n">history</span>
      <span class="mi">6</span>  <span class="mi">2013</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mi">09</span> <span class="mi">10</span><span class="o">:</span><span class="mi">40</span><span class="o">:</span><span class="mi">12</span>   <span class="n">PS1</span><span class="o">=</span><span class="err">&#39;\</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">;</span><span class="mi">35</span><span class="n">m</span><span class="p">[</span><span class="err">\</span><span class="n">u</span><span class="err">@\</span><span class="n">h</span> <span class="err">\</span><span class="n">w</span><span class="p">]</span><span class="err">$</span> <span class="err">\</span><span class="n">e</span><span class="p">[</span><span class="n">m</span> <span class="err">&#39;</span>
      <span class="mi">7</span>  <span class="mi">2013</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mi">09</span> <span class="mi">10</span><span class="o">:</span><span class="mi">40</span><span class="o">:</span><span class="mi">12</span>   <span class="n">PS1</span><span class="o">=</span><span class="s">&quot;\e[0;32m[\u@\h \W]$ \e[m &quot;</span>
      <span class="mi">8</span>  <span class="mi">2013</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mi">09</span> <span class="mi">10</span><span class="o">:</span><span class="mi">40</span><span class="o">:</span><span class="mi">12</span>   <span class="n">PS1</span><span class="o">=</span><span class="s">&quot;\u@\h:\w [\j]$ &quot;</span>
      <span class="mi">9</span>  <span class="mi">2013</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mi">09</span> <span class="mi">10</span><span class="o">:</span><span class="mi">40</span><span class="o">:</span><span class="mi">12</span>   <span class="n">ping</span> <span class="n">google</span><span class="p">.</span><span class="n">com</span>
     <span class="mi">10</span>  <span class="mi">2013</span><span class="o">-</span><span class="mo">06</span><span class="o">-</span><span class="mi">09</span> <span class="mi">10</span><span class="o">:</span><span class="mi">40</span><span class="o">:</span><span class="mi">12</span>   <span class="n">echo</span> <span class="err">$</span><span class="n">PS1</span>
</pre></div>


<h2 id="histcontrol">HISTCONTROL 控制</h2>
<h3 id="ignoredups">ignoredups 过滤重复</h3>
<div class="hlcode"><pre><span class="err">$</span> <span class="n">export</span> <span class="n">HISTCONTROL</span><span class="o">=</span><span class="n">ignoredups</span>
</pre></div>


<h3 id="unset-export">unset export 关闭定义</h3>
<div class="hlcode"><pre><span class="err">$</span> <span class="n">unset</span> <span class="n">export</span> <span class="n">HISTCONTROL</span>
</pre></div>


<h2 id="_5">系统内置变量</h2>
<div class="hlcode"><pre><span class="err">$</span><span class="n">HOME</span><span class="p">,</span> <span class="err">$</span><span class="n">PWD</span><span class="p">,</span> <span class="err">$</span><span class="n">SHELL</span><span class="p">,</span> <span class="err">$</span><span class="n">USER</span> <span class="err">等</span>
</pre></div>


<div class="hlcode"><pre><span class="err">$</span> <span class="n">echo</span> <span class="err">$</span><span class="n">USER</span>
<span class="n">rxu</span>
</pre></div>


<h1 id="_6">特殊变量</h1>
<h2 id="n"><code>$n</code></h2>
<p>n为数字</p>
<p>表示第几个位置参数</p>
<h2 id="_7"><code>$#</code></h2>
<p>获取所有参数个数，常用于循环</p>
<p>类似于</p>
<div class="hlcode"><pre><span class="n">public</span> <span class="k">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
        <span class="err">$</span><span class="mi">1</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="err">$#</span> <span class="o">=</span> <span class="n">args</span><span class="p">.</span><span class="n">length</span>
<span class="p">}</span>
</pre></div>


<h2 id="_8"><code>$*</code></h2>
<p>获取所有参数，会把其看成一个整体</p>
<h2 id="_9"><code>$@</code></h2>
<p>获取所有参数，但是区分对待每一个参数</p>
<h2 id="_10"><code>$?</code></h2>
<p>上一次命令执行的返回状态</p>
<p>0表示执行正确，非0表示错误</p>
    </div>
    <div id="footer">
      <span>
        <p>Copyright © 2020 Xu XueHua.
        Powered by <a href="http://simiki.org/" target="_blank">Simiki</a>.</p>
        <p>Site Generated 2020-12-12 14:54:32</p>
      </span>
    </div>

    
    
  </body>
</html>