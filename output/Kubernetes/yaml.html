<!DOCTYPE HTML>
<html>
  <head>
    <link rel="Stylesheet" type="text/css" href="/static/css/style.css">
    <link rel="Stylesheet" type="text/css" href="/static/css/tango.css">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="alternate" type="application/atom+xml" href="atom.xml" title="Atom feed">
    <title>yaml - Xu XueHua</title>
    <meta name="keywords" content="Xu XueHua"/>
    <meta name="description" content="Xu XueHua's public notes"/>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  </head>

  <body>
    <div id="container">
      
<div id="header">
  <div class="post-nav"><a href="/">Home</a>&nbsp;&#187;&nbsp;<a href="/#Kubernetes">Kubernetes</a>&nbsp;&#187;&nbsp;yaml
    <span class="updated">Page Updated&nbsp;
      2019-03-08 11:59
    </span></div>
</div>
<div class="clearfix"></div>

<div class="page_title">yaml</div>

  <div class="toc"><span class="toctitle">Table of Contents</span><ul>
<li><a href="#apiversion">apiVersion</a></li>
<li><a href="#kind">kind 资源类别</a><ul>
<li><a href="#pod">Pod</a></li>
<li><a href="#secret">Secret</a></li>
</ul>
</li>
<li><a href="#metadata">Metadata</a><ul>
<li><a href="#name">name</a></li>
<li><a href="#namespace">namespace</a></li>
<li><a href="#labels">labels (重要)</a></li>
<li><a href="#annotation">annotation</a></li>
<li><a href="#ownerreference">ownerReference</a></li>
<li><a href="#annotations">annotations</a></li>
<li><a href="#initializers">initializers</a></li>
</ul>
</li>
<li><a href="#spec">Spec 对象独有定义</a><ul>
<li><a href="#_1">仔细阅读</a></li>
<li><a href="#kubectl-explain-specobject">Kubectl explain spec.[Object]</a></li>
<li><a href="#initcontainers">initContainers</a></li>
<li><a href="#containers">containers 容器列表</a><ul>
<li><a href="#name-string">name &lt;string&gt;</a></li>
<li><a href="#image-string">image &lt;string&gt;</a></li>
<li><a href="#imagepullpolicy-string">imagePullPolicy &lt;string&gt;</a></li>
<li><a href="#ports-object">ports &lt;[]Object&gt;</a></li>
<li><a href="#command-string">command &lt;[]string&gt;</a></li>
<li><a href="#lifecycle">Lifecycle</a><ul>
<li><a href="#poststart-object">postStart   &lt;Object&gt;</a><ul>
<li><a href="#exec-object">exec &lt;Object&gt; 用户指定命令</a></li>
<li><a href="#httpget-object">httpGet      &lt;Object&gt;</a></li>
<li><a href="#tcpsocket-object">tcpSocket    &lt;Object&gt;</a></li>
</ul>
</li>
<li><a href="#prestop-object">preStop     &lt;Object&gt; 终止前</a><ul>
<li><a href="#exec-object_1">exec &lt;Object&gt; 用户指定命令</a></li>
<li><a href="#httpget-object_1">httpGet      &lt;Object&gt;</a></li>
<li><a href="#tcpsocket-object_1">tcpSocket    &lt;Object&gt;</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#livenessprobe">livenessProbe</a><ul>
<li><a href="#exec">exec</a></li>
<li><a href="#httpget">httpGet</a></li>
<li><a href="#tcpsocket">tcpSocket</a></li>
</ul>
</li>
<li><a href="#readinessprobe">readinessProbe</a></li>
</ul>
</li>
<li><a href="#selector">selector</a><ul>
<li><a href="#matchlabels-label-selector">matchLabels （Label Selector）</a></li>
<li><a href="#matchexpressions">matchExpressions</a></li>
</ul>
</li>
<li><a href="#nodeselector-deprecated-by-nodeaffinity">nodeSelector (Deprecated by nodeAffinity)</a></li>
<li><a href="#nodename">nodeName</a></li>
<li><a href="#nodeaffinity">nodeAffinity</a></li>
<li><a href="#sessionaffinity">sessionAffinity</a></li>
<li><a href="#hostaliases">hostAliases</a></li>
<li><a href="#hostnetworkhostipchostpid">hostNetwork/hostIPC/hostPID</a></li>
<li><a href="#shareprocessnamespace">shareProcessNamespace</a></li>
<li><a href="#restartpolicy">restartPolicy</a><ul>
<li><a href="#_2">恢复策略</a></li>
<li><a href="#_3">恢复原理</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#status-read-only">status 当前状态 (read-only)</a><ul>
<li><a href="#activedeadlineseconds">activeDeadlineSeconds</a></li>
<li><a href="#parallelism">parallelism</a></li>
<li><a href="#completions">completions</a></li>
<li><a href="#rollingupdatestrategy">RollingUpdateStrategy</a></li>
<li><a href="#revisionhistorylimit">revisionHistoryLimit</a></li>
<li><a href="#volumeclaimtemplates">volumeClaimTemplates</a></li>
</ul>
</li>
</ul>
</div>
<h1 id="apiversion">apiVersion</h1>
<div class="hlcode"><pre><span class="n">group_name</span><span class="o">/</span><span class="n">version</span>
</pre></div>


<blockquote>
<p>group_name 省略表示 core核心群组</p>
</blockquote>
<p>指明资源所在群组以及版本</p>
<div class="hlcode"><pre><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">master</span> <span class="o">~</span><span class="p">]</span><span class="err">#</span> <span class="n">kubectl</span> <span class="n">api</span><span class="o">-</span><span class="n">versions</span>
<span class="n">admissionregistration</span><span class="p">.</span><span class="n">k8s</span><span class="p">.</span><span class="n">io</span><span class="o">/</span><span class="n">v1beta1</span>
<span class="n">apiextensions</span><span class="p">.</span><span class="n">k8s</span><span class="p">.</span><span class="n">io</span><span class="o">/</span><span class="n">v1beta1</span>
<span class="n">apiregistration</span><span class="p">.</span><span class="n">k8s</span><span class="p">.</span><span class="n">io</span><span class="o">/</span><span class="n">v1</span>
<span class="n">apiregistration</span><span class="p">.</span><span class="n">k8s</span><span class="p">.</span><span class="n">io</span><span class="o">/</span><span class="n">v1beta1</span>
<span class="n">apps</span><span class="o">/</span><span class="n">v1</span>
<span class="n">apps</span><span class="o">/</span><span class="n">v1beta1</span>
<span class="n">apps</span><span class="o">/</span><span class="n">v1beta2</span>
<span class="n">authentication</span><span class="p">.</span><span class="n">k8s</span><span class="p">.</span><span class="n">io</span><span class="o">/</span><span class="n">v1</span>
<span class="n">authentication</span><span class="p">.</span><span class="n">k8s</span><span class="p">.</span><span class="n">io</span><span class="o">/</span><span class="n">v1beta1</span>
<span class="n">authorization</span><span class="p">.</span><span class="n">k8s</span><span class="p">.</span><span class="n">io</span><span class="o">/</span><span class="n">v1</span>
<span class="n">authorization</span><span class="p">.</span><span class="n">k8s</span><span class="p">.</span><span class="n">io</span><span class="o">/</span><span class="n">v1beta1</span>
<span class="n">autoscaling</span><span class="o">/</span><span class="n">v1</span>
<span class="n">autoscaling</span><span class="o">/</span><span class="n">v2beta1</span>
<span class="n">autoscaling</span><span class="o">/</span><span class="n">v2beta2</span>
<span class="n">batch</span><span class="o">/</span><span class="n">v1</span>
<span class="n">batch</span><span class="o">/</span><span class="n">v1beta1</span>
<span class="n">certificates</span><span class="p">.</span><span class="n">k8s</span><span class="p">.</span><span class="n">io</span><span class="o">/</span><span class="n">v1beta1</span>
<span class="n">coordination</span><span class="p">.</span><span class="n">k8s</span><span class="p">.</span><span class="n">io</span><span class="o">/</span><span class="n">v1</span>
<span class="n">coordination</span><span class="p">.</span><span class="n">k8s</span><span class="p">.</span><span class="n">io</span><span class="o">/</span><span class="n">v1beta1</span>
<span class="n">events</span><span class="p">.</span><span class="n">k8s</span><span class="p">.</span><span class="n">io</span><span class="o">/</span><span class="n">v1beta1</span>
<span class="n">extensions</span><span class="o">/</span><span class="n">v1beta1</span>
<span class="n">networking</span><span class="p">.</span><span class="n">k8s</span><span class="p">.</span><span class="n">io</span><span class="o">/</span><span class="n">v1</span>
<span class="n">networking</span><span class="p">.</span><span class="n">k8s</span><span class="p">.</span><span class="n">io</span><span class="o">/</span><span class="n">v1beta1</span>
<span class="n">node</span><span class="p">.</span><span class="n">k8s</span><span class="p">.</span><span class="n">io</span><span class="o">/</span><span class="n">v1beta1</span>
<span class="n">policy</span><span class="o">/</span><span class="n">v1beta1</span>
<span class="n">rbac</span><span class="p">.</span><span class="n">authorization</span><span class="p">.</span><span class="n">k8s</span><span class="p">.</span><span class="n">io</span><span class="o">/</span><span class="n">v1</span>
<span class="n">rbac</span><span class="p">.</span><span class="n">authorization</span><span class="p">.</span><span class="n">k8s</span><span class="p">.</span><span class="n">io</span><span class="o">/</span><span class="n">v1beta1</span>
<span class="n">scheduling</span><span class="p">.</span><span class="n">k8s</span><span class="p">.</span><span class="n">io</span><span class="o">/</span><span class="n">v1</span>
<span class="n">scheduling</span><span class="p">.</span><span class="n">k8s</span><span class="p">.</span><span class="n">io</span><span class="o">/</span><span class="n">v1beta1</span>
<span class="n">storage</span><span class="p">.</span><span class="n">k8s</span><span class="p">.</span><span class="n">io</span><span class="o">/</span><span class="n">v1</span>
<span class="n">storage</span><span class="p">.</span><span class="n">k8s</span><span class="p">.</span><span class="n">io</span><span class="o">/</span><span class="n">v1beta1</span>
<span class="n">v1</span>
</pre></div>


<h1 id="kind">kind 资源类别</h1>
<p>初始化资源对象时使用</p>
<p>如Pod，Replicas， deployment， StatefulSet</p>
<h2 id="pod">Pod</h2>
<p>Pod预先设置</p>
<p>pod.yaml</p>
<div class="hlcode"><pre><span class="n">apiVersion</span><span class="o">:</span> <span class="n">v1</span>
<span class="n">kind</span><span class="o">:</span> <span class="n">Pod</span>
<span class="n">metadata</span><span class="o">:</span>
  <span class="n">name</span><span class="o">:</span> <span class="n">website</span>
  <span class="n">labels</span><span class="o">:</span>
    <span class="n">app</span><span class="o">:</span> <span class="n">website</span>
    <span class="n">role</span><span class="o">:</span> <span class="n">frontend</span>
<span class="n">spec</span><span class="o">:</span>
  <span class="n">containers</span><span class="o">:</span>
    <span class="o">-</span> <span class="n">name</span><span class="o">:</span> <span class="n">website</span>
      <span class="n">image</span><span class="o">:</span> <span class="n">nginx</span>
      <span class="n">ports</span><span class="o">:</span>
        <span class="o">-</span> <span class="n">containerPort</span><span class="o">:</span> <span class="mi">80</span>
</pre></div>


<p>preset.yaml</p>
<div class="hlcode"><pre><span class="n">apiVersion</span><span class="o">:</span> <span class="n">settings</span><span class="o">.</span><span class="na">k8s</span><span class="o">.</span><span class="na">io</span><span class="o">/</span><span class="n">v1alpha1</span>
<span class="n">kind</span><span class="o">:</span> <span class="n">PodPreset</span>
<span class="n">metadata</span><span class="o">:</span>
  <span class="n">name</span><span class="o">:</span> <span class="n">allow</span><span class="o">-</span><span class="n">database</span>
<span class="n">spec</span><span class="o">:</span>
  <span class="n">selector</span><span class="o">:</span>
    <span class="n">matchLabels</span><span class="o">:</span>
      <span class="n">role</span><span class="o">:</span> <span class="n">frontend</span>
  <span class="n">env</span><span class="o">:</span>
    <span class="o">-</span> <span class="n">name</span><span class="o">:</span> <span class="n">DB_PORT</span>
      <span class="n">value</span><span class="o">:</span> <span class="s2">&quot;6379&quot;</span>
  <span class="n">volumeMounts</span><span class="o">:</span>
    <span class="o">-</span> <span class="n">mountPath</span><span class="o">:</span> <span class="o">/</span><span class="n">cache</span>
      <span class="n">name</span><span class="o">:</span> <span class="n">cache</span><span class="o">-</span><span class="n">volume</span>
  <span class="n">volumes</span><span class="o">:</span>
    <span class="o">-</span> <span class="n">name</span><span class="o">:</span> <span class="n">cache</span><span class="o">-</span><span class="n">volume</span>
      <span class="n">emptyDir</span><span class="o">:</span> <span class="o">{}</span>
</pre></div>


<blockquote>
<p>在这个 PodPreset 的定义中，首先是一个 selector。这就意味着后面这些追加的定义，只会作用于 selector 所定义的、带有“role: frontend”标签的 Pod 对象，这就可以防止“误伤”。</p>
<p>然后，我们定义了一组 Pod 的 Spec 里的标准字段，以及对应的值。比如，env 里定义了 DB_PORT 这个环境变量，volumeMounts 定义了容器 Volume 的挂载目录，volumes 定义了一个 emptyDir 的 Volume。</p>
</blockquote>
<p>现运行preset，然后在运行pod</p>
<div class="hlcode"><pre><span class="err">$</span> <span class="n">kubectl</span> <span class="n">create</span> <span class="o">-</span><span class="n">f</span> <span class="n">preset</span><span class="p">.</span><span class="n">yaml</span>
<span class="err">$</span> <span class="n">kubectl</span> <span class="n">create</span> <span class="o">-</span><span class="n">f</span> <span class="n">pod</span><span class="p">.</span><span class="n">yaml</span>
</pre></div>


<div class="hlcode"><pre><span class="err">$</span> <span class="n">kubectl</span> <span class="n">get</span> <span class="n">pod</span> <span class="n">website</span> <span class="o">-</span><span class="n">o</span> <span class="n">yaml</span>
<span class="nl">apiVersion:</span> <span class="n">v1</span>
<span class="nl">kind:</span> <span class="n">Pod</span>
<span class="nl">metadata:</span>
  <span class="nl">name:</span> <span class="n">website</span>
  <span class="nl">labels:</span>
    <span class="nl">app:</span> <span class="n">website</span>
    <span class="nl">role:</span> <span class="n">frontend</span>
  <span class="nl">annotations:</span>
    <span class="n">podpreset</span><span class="p">.</span><span class="n">admission</span><span class="p">.</span><span class="n">kubernetes</span><span class="p">.</span><span class="n">io</span><span class="o">/</span><span class="n">podpreset</span><span class="o">-</span><span class="n">allow</span><span class="o">-</span><span class="n">database</span><span class="o">:</span> <span class="s">&quot;resource version&quot;</span>
<span class="nl">spec:</span>
  <span class="nl">containers:</span>
    <span class="o">-</span> <span class="n">name</span><span class="o">:</span> <span class="n">website</span>
      <span class="nl">image:</span> <span class="n">nginx</span>
      <span class="nl">volumeMounts:</span>
        <span class="o">-</span> <span class="n">mountPath</span><span class="o">:</span> <span class="o">/</span><span class="n">cache</span>
          <span class="nl">name:</span> <span class="n">cache</span><span class="o">-</span><span class="n">volume</span>
      <span class="nl">ports:</span>
        <span class="o">-</span> <span class="n">containerPort</span><span class="o">:</span> <span class="mi">80</span>
      <span class="nl">env:</span>
        <span class="o">-</span> <span class="n">name</span><span class="o">:</span> <span class="n">DB_PORT</span>
          <span class="nl">value:</span> <span class="s">&quot;6379&quot;</span>
  <span class="nl">volumes:</span>
    <span class="o">-</span> <span class="n">name</span><span class="o">:</span> <span class="n">cache</span><span class="o">-</span><span class="n">volume</span>
      <span class="nl">emptyDir:</span> <span class="p">{}</span>
</pre></div>


<blockquote>
<p>这个时候，我们就可以清楚地看到，这个 Pod 里多了新添加的 labels、env、volumes 和 volumeMount 的定义，它们的配置跟 PodPreset 的内容一样。此外，这个 Pod 还被自动加上了一个 annotation 表示这个 Pod 对象被 PodPreset 改动过。</p>
</blockquote>
<h2 id="secret">Secret</h2>
<div class="hlcode"><pre><span class="n">apiVersion</span><span class="o">:</span> <span class="n">v1</span>
<span class="n">kind</span><span class="o">:</span> <span class="n">Secret</span>
<span class="n">metadata</span><span class="o">:</span>
  <span class="n">name</span><span class="o">:</span> <span class="n">mysecret</span>
<span class="n">type</span><span class="o">:</span> <span class="n">Opaque</span>
<span class="n">data</span><span class="o">:</span>
  <span class="n">user</span><span class="o">:</span> <span class="n">YWRtaW4</span><span class="o">=</span>
  <span class="n">pass</span><span class="o">:</span> <span class="n">MWYyZDFlMmU2N2Rm</span>
</pre></div>


<h1 id="metadata">Metadata</h1>
<p>API对象的“标识”，即元数据，也是从Kubernetes里找到这个对象的主要依据，对所有API对象来说，这一部分的格式和字段基本是一致的</p>
<p>其中最主要使用到的字段是Labels</p>
<p>嵌套字段</p>
<h2 id="name">name</h2>
<p>在同一类别中，name必须是唯一的</p>
<p>实例化对象的名称</p>
<h2 id="namespace">namespace</h2>
<p>实例化对象资源的名称空间</p>
<p>name是受限于namespace的</p>
<h2 id="labels">labels (重要)</h2>
<p>key-value 数据</p>
<p>key最多63个字符，只能使用字母，数字，下划线，横线</p>
<p>value 可以为空，只能字母或者数字开头及结尾</p>
<p>资源对象进行管理，可以添加多个标签</p>
<div class="hlcode"><pre><span class="n">apiVersion</span><span class="o">:</span> <span class="n">v1</span>
<span class="n">kind</span><span class="o">:</span> <span class="n">Pod</span>
<span class="n">metadata</span><span class="o">:</span>
  <span class="n">name</span><span class="o">:</span> <span class="n">pod</span><span class="o">-</span><span class="k">with</span><span class="o">-</span><span class="n">labels</span>
  <span class="n">labels</span><span class="o">:</span>
    <span class="n">env</span><span class="o">:</span> <span class="n">qa</span>
    <span class="n">tier</span><span class="o">:</span> <span class="n">frontend</span>
<span class="n">spec</span><span class="o">:</span> 
  <span class="n">containers</span><span class="o">:</span>
  <span class="o">-</span> <span class="n">name</span><span class="o">:</span> <span class="n">myapp</span>
    <span class="n">image</span><span class="o">:</span> <span class="n">ikubernetes</span><span class="o">/</span><span class="n">myapp</span><span class="o">:</span><span class="n">v1</span>
</pre></div>


<h2 id="annotation">annotation</h2>
<p>资源注解</p>
<h2 id="ownerreference">ownerReference</h2>
<p>用于保存当前这个API对象的拥有者(Owner) 的信息</p>
<p>每个资源引用的PATH</p>
<div class="hlcode"><pre><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">GROUP</span><span class="o">/</span><span class="n">VERSION</span><span class="o">/</span><span class="n">namespaces</span><span class="o">/</span><span class="n">NAMESPACE</span><span class="o">/</span><span class="n">RESOURCE_TYPE</span><span class="o">/</span><span class="n">NAME</span>
</pre></div>


<h2 id="annotations">annotations</h2>
<p>不能用于挑选资源对象，仅用于对象提供元数据</p>
<p>key value不受限制</p>
<p>支持动态编辑</p>
<p>生成资源注解</p>
<div class="hlcode"><pre><span class="n">apiVersion</span><span class="o">:</span> <span class="n">v1</span>
<span class="n">kind</span><span class="o">:</span> <span class="n">Pod</span>
<span class="n">metadata</span><span class="o">:</span>
  <span class="n">name</span><span class="o">:</span> <span class="n">pod</span><span class="o">-</span><span class="k">with</span><span class="o">-</span><span class="n">nodeselector</span>
  <span class="n">annotations</span><span class="o">:</span>
    <span class="n">xuxuehua</span><span class="o">.</span><span class="na">com</span><span class="o">/</span><span class="n">created</span><span class="o">-</span><span class="n">by</span><span class="o">:</span> <span class="s2">&quot;cluster admin&quot;</span>
<span class="n">spec</span><span class="o">:</span> 
<span class="o">....</span>
</pre></div>


<h2 id="initializers">initializers</h2>
<p>Kubernetes 还允许你通过配置，来指定要对什么样的资源进行这个 Initialize 操作</p>
<div class="hlcode"><pre><span class="n">apiVersion</span><span class="o">:</span> <span class="n">admissionregistration</span><span class="o">.</span><span class="na">k8s</span><span class="o">.</span><span class="na">io</span><span class="o">/</span><span class="n">v1alpha1</span> 
<span class="n">kind</span><span class="o">:</span> <span class="n">InitializerConfiguration</span>
<span class="n">metadata</span><span class="o">:</span>
  <span class="n">name</span><span class="o">:</span> <span class="n">envoy</span><span class="o">-</span><span class="n">config</span> 
  <span class="n">initializers</span><span class="o">:</span>
  <span class="c1">// 这个名字必须至少包括两个 &quot;.&quot;</span>
    <span class="o">-</span> <span class="n">name</span><span class="o">:</span> <span class="n">envoy</span><span class="o">.</span><span class="na">initializer</span><span class="o">.</span><span class="na">kubernetes</span><span class="o">.</span><span class="na">io</span>
      <span class="n">rules</span><span class="o">:</span>
        <span class="o">-</span> <span class="n">apiGroups</span><span class="o">:</span>
          <span class="o">-</span> <span class="s2">&quot;&quot;</span> <span class="c1">// 前面说过， &quot;&quot; 就是 core API Group 的意思 </span>
        <span class="n">apiVersions</span><span class="o">:</span>
          <span class="o">-</span> <span class="n">v1</span> 
        <span class="n">resources</span><span class="o">:</span>
          <span class="o">-</span> <span class="n">pods</span>
</pre></div>


<p>这个配置，就意味着 Kubernetes 要对所有的 Pod 进行这个 Initialize 操作，并且，我们指定了 负责这个操作的 Initializer，名叫:envoy-initializer。</p>
<p>一旦这个 InitializerConfiguration 被创建，Kubernetes 就会把这个 Initializer 的名字，加 在所有新创建的 Pod 的 Metadata 上</p>
<div class="hlcode"><pre><span class="n">apiVersion</span><span class="o">:</span> <span class="n">admissionregistration</span><span class="o">.</span><span class="na">k8s</span><span class="o">.</span><span class="na">io</span><span class="o">/</span><span class="n">v1alpha1</span> 
<span class="n">kind</span><span class="o">:</span> <span class="n">InitializerConfiguration</span>
<span class="n">metadata</span><span class="o">:</span>
  <span class="n">name</span><span class="o">:</span> <span class="n">envoy</span><span class="o">-</span><span class="n">config</span> 
  <span class="n">initializers</span><span class="o">:</span>
    <span class="n">pending</span><span class="o">:</span>
      <span class="o">-</span> <span class="n">name</span><span class="o">:</span> <span class="n">envoy</span><span class="o">.</span><span class="na">initializer</span><span class="o">.</span><span class="na">kubernetes</span><span class="o">.</span><span class="na">io</span>
  <span class="n">name</span><span class="o">:</span> <span class="n">myapp</span><span class="o">-</span><span class="n">pod</span> 
  <span class="n">labels</span><span class="o">:</span> 
    <span class="n">app</span><span class="o">:</span> <span class="n">myapp</span>
</pre></div>


<p>可以看到，每一个新创建的 Pod，都会自动携带了 metadata.initializers.pending 的 Metadata 信息。</p>
<p>这个 Metadata，正是接下来 Initializer 的控制器判断这个 Pod 有没有执行过自己所负责的初 始化操作的重要依据(也就是前面伪代码中 isInitialized() 方法的含义)。</p>
<p>这也就意味着，当你在 Initializer 里完成了要做的操作后，一定要记得将这个 metadata.initializers.pending 标志清除掉。这一点，你在编写 Initializer 代码的时候一定要非常注意。</p>
<p>此外，除了上面的配置方法，你还可以在具体的 Pod 的 Annotation 里添加一个如下所示的字 段，从而声明要使用某个 Initializer</p>
<div class="hlcode"><pre><span class="n">apiVersion</span><span class="o">:</span> <span class="n">v1</span>
<span class="n">kind</span><span class="o">:</span> <span class="n">Pod</span>
<span class="n">metadata</span>
  <span class="n">annotations</span><span class="o">:</span> 
    <span class="s2">&quot;initializer.kubernetes.io/envoy&quot;</span><span class="o">:</span> <span class="s2">&quot;true&quot;</span> 
    <span class="o">...</span>
</pre></div>


<p>在这个 Pod 里，我们添加了一个 Annotation，写明: initializer.kubernetes.io/envoy=true。这样，就会使用到我们前面所定义的 envoy-initializer 了</p>
<h1 id="spec">Spec 对象独有定义</h1>
<p>specification 规格</p>
<p>存放属于这个对象独有的定义，用来描述它要表达的功能</p>
<p>即用户来定义资源所期望的目标状态</p>
<h2 id="_1">仔细阅读</h2>
<p>仔细阅读 $GOPATH/src/k8s.io/kubernetes/vendor/k8s.io/api/core/v1/types.go 里，type Pod struct ，尤其是 PodSpec 部分的内容。争取做到下次看到一个 Pod 的 YAML 文件时，不再需要查阅文档，就能做到把常用字段及其作用信手拈来。</p>
<h2 id="kubectl-explain-specobject">Kubectl explain spec.[Object]</h2>
<p>返回为对象，可以一直向下嵌套</p>
<h2 id="initcontainers">initContainers</h2>
<p>所有 Init Container 定义的容器，都会比 spec.containers 定义的用户容器先启动。并 且，Init Container 容器会按顺序逐一启动，而直到它们都启动并且退出了，用户容器才会启动。</p>
<p>可以解决在一个pod中，多个容器间的启动顺序</p>
<p>实际上，这个所谓的“组合”操作，正是容器设计模式里最常用的一种模式，它的名字叫: sidecar。</p>
<div class="hlcode"><pre><span class="n">apiVersion</span><span class="o">:</span> <span class="n">v1</span>
<span class="n">kind</span><span class="o">:</span> <span class="n">Pod</span>
<span class="n">metadata</span><span class="o">:</span>
  <span class="n">name</span><span class="o">:</span> <span class="n">myapp</span><span class="o">-</span><span class="n">pod</span> 
  <span class="n">labels</span><span class="o">:</span>
    <span class="n">app</span><span class="o">:</span> <span class="n">myapp</span>
<span class="n">spec</span><span class="o">:</span> 
  <span class="n">containers</span><span class="o">:</span>
  <span class="o">-</span> <span class="n">name</span><span class="o">:</span> <span class="n">myapp</span><span class="o">-</span><span class="n">container</span>
    <span class="n">image</span><span class="o">:</span> <span class="n">ikubernetes</span><span class="o">/</span><span class="n">myapp</span><span class="o">:</span><span class="n">v1</span>
  <span class="n">initContainers</span><span class="o">:</span>
  <span class="o">-</span> <span class="n">name</span><span class="o">:</span> <span class="n">init</span><span class="o">-</span><span class="n">something</span>
    <span class="n">image</span><span class="o">:</span> <span class="n">busybox</span>
    <span class="n">command</span><span class="o">:</span> <span class="o">[</span><span class="s1">&#39;sh&#39;</span><span class="o">,</span> <span class="s1">&#39;-c&#39;</span><span class="o">,</span> <span class="s1">&#39;sleep 10&#39;</span><span class="o">]</span>
</pre></div>


<h2 id="containers">containers 容器列表</h2>
<p>内容为列表，开头需要添加 <code>-</code></p>
<h3 id="name-string">name <code>&lt;string&gt;</code></h3>
<p>pod 内嵌的容器名称</p>
<h3 id="image-string">image <code>&lt;string&gt;</code></h3>
<p>pod 容器使用的镜像</p>
<p>若为自定义仓库，需要指明仓库路径以及名称</p>
<h3 id="imagepullpolicy-string">imagePullPolicy <code>&lt;string&gt;</code></h3>
<p>定义了拉取镜像的策略</p>
<p>默认策略为Always，即每次创建Pod的时候会重新拉取一次镜像</p>
<p>IfNotPresent  仅当本地镜像缺失时方才从目标仓库中下载镜像<br />
Never 禁止从仓库中下载镜像，仅仅使用本地镜像</p>
<div class="hlcode"><pre><span class="n">apiVersion</span><span class="o">:</span> <span class="n">v1</span>
<span class="n">kind</span><span class="o">:</span> <span class="n">Pod</span>
<span class="n">metadata</span><span class="o">:</span>
  <span class="n">name</span><span class="o">:</span> <span class="n">nginx</span><span class="o">-</span><span class="n">pod</span>
<span class="n">spec</span><span class="o">:</span>
  <span class="n">containers</span><span class="o">:</span>
    <span class="o">-</span> <span class="n">name</span><span class="o">:</span> <span class="n">nginx</span>
      <span class="n">image</span><span class="o">:</span> <span class="n">nginx</span><span class="o">:</span><span class="n">latest</span>
        <span class="n">imagePullPolicy</span><span class="o">:</span> <span class="n">Always</span>
</pre></div>


<blockquote>
<p>总是从镜像仓库中获取最新的nginx 镜像</p>
</blockquote>
<h3 id="ports-object">ports <code>&lt;[]Object&gt;</code></h3>
<p>暴露一个端口，仅仅是提供额外信息</p>
<p>显示指定容器端口，为其赋予一个名称方便调用</p>
<p>其值为一个对象列表，有一个到多个端口对象组成，且嵌套以下字段</p>
<div class="hlcode"><pre><span class="nx">containerPort</span> <span class="o">&lt;</span><span class="kt">integer</span><span class="o">&gt;</span> <span class="nx">必选字段</span><span class="err">，</span><span class="nx">指定Pod的IP地址暴露的容器端口</span> <span class="mi">0</span><span class="o">-</span><span class="mi">65536</span>
<span class="nb">name</span> <span class="o">&lt;</span><span class="kt">string</span><span class="o">&gt;</span> <span class="nx">当前容器端口名称</span><span class="err">，</span><span class="nx">在当前pod内需要唯一</span><span class="err">，</span><span class="nx">此端口名可以被Service资源调用</span>
<span class="nx">protocol</span> <span class="nx">可以为TCP或UDP</span><span class="err">，</span><span class="nx">默认为TCP</span>
</pre></div>


<div class="hlcode"><pre><span class="n">apiVersion</span><span class="o">:</span> <span class="n">v1</span>
<span class="n">kind</span><span class="o">:</span> <span class="n">Pod</span>
<span class="n">metadata</span><span class="o">:</span>
  <span class="n">name</span><span class="o">:</span> <span class="n">pod</span><span class="o">-</span><span class="n">example</span>
<span class="n">spec</span><span class="o">:</span>
  <span class="n">containers</span><span class="o">:</span>
    <span class="o">-</span> <span class="n">name</span><span class="o">:</span> <span class="n">myapp</span>
      <span class="n">image</span><span class="o">:</span> <span class="n">ikubernetes</span><span class="o">/</span><span class="n">myapp</span><span class="o">:</span><span class="n">v1</span>
      <span class="n">ports</span><span class="o">:</span>
        <span class="o">-</span> <span class="n">name</span><span class="o">:</span> <span class="n">http</span>
          <span class="n">containerPort</span><span class="o">:</span> <span class="mi">80</span>
          <span class="n">protocol</span><span class="o">:</span> <span class="n">TCP</span>
</pre></div>


<h3 id="command-string">command <code>&lt;[]string&gt;</code></h3>
<p>指定不同于镜像默认运行的应用程序，可以同时使用args字段进行参数传递，将覆盖镜像中的默认定义</p>
<p>自定义args 将传递args内容作为参数，而镜像中的CMD参数将会被忽略</p>
<p>其内部的变量引用格式为<code>$(VAR_NAME)</code>, 逃逸方式为<code>$$(VAR_NAME)</code></p>
<div class="hlcode"><pre><span class="n">apiVersion</span><span class="o">:</span> <span class="n">v1</span>
<span class="n">kind</span><span class="o">:</span> <span class="n">Pod</span>
<span class="n">metadata</span><span class="o">:</span>
  <span class="n">name</span><span class="o">:</span> <span class="n">pod</span><span class="o">-</span><span class="k">with</span><span class="o">-</span><span class="n">custom</span><span class="o">-</span><span class="n">command</span>
<span class="n">spec</span><span class="o">:</span>
  <span class="n">containers</span><span class="o">:</span>
    <span class="o">-</span> <span class="n">name</span><span class="o">:</span> <span class="n">myapp</span>
      <span class="n">image</span><span class="o">:</span> <span class="n">alpine</span><span class="o">:</span><span class="n">latest</span>
      <span class="n">command</span><span class="o">:</span> <span class="o">[</span><span class="s2">&quot;/bin/sh&quot;</span><span class="o">]</span>
      <span class="n">args</span><span class="o">:</span> <span class="o">[</span><span class="s2">&quot;-c&quot;</span><span class="o">,</span> <span class="s2">&quot;while true; do sleep 30; done&quot;</span><span class="o">]</span>
</pre></div>


<p>This table summarizes the field names used by Docker and Kubernetes.</p>
<table>
<thead>
<tr>
<th align="left">Description</th>
<th align="left">Docker field name</th>
<th align="left">Kubernetes field name</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">The command run by the container</td>
<td align="left">Entrypoint</td>
<td align="left">command</td>
</tr>
<tr>
<td align="left">The arguments passed to the command</td>
<td align="left">Cmd</td>
<td align="left">args</td>
</tr>
</tbody>
</table>
<p>When you override the default Entrypoint and Cmd, these rules apply:</p>
<ul>
<li>If you do not supply <code>command</code> or <code>args</code> for a Container, the defaults defined in the Docker image are used.</li>
<li>If you supply a <code>command</code> but no <code>args</code> for a Container, only the supplied <code>command</code> is used. The default EntryPoint and the default Cmd defined in the Docker image are ignored.</li>
<li>If you supply only <code>args</code> for a Container, the default Entrypoint defined in the Docker image is run with the <code>args</code> that you supplied.</li>
<li>If you supply a <code>command</code> and <code>args</code>, the default Entrypoint and the default Cmd defined in the Docker image are ignored. Your <code>command</code> is run with your <code>args</code>.</li>
</ul>
<p>Here are some examples:</p>
<table>
<thead>
<tr>
<th align="left">Image Entrypoint</th>
<th align="left">Image Cmd</th>
<th align="left">Container command</th>
<th align="left">Container args</th>
<th align="left">Command run</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>[/ep-1]</code></td>
<td align="left"><code>[foo bar]</code></td>
<td align="left"><not set></td>
<td align="left"><not set></td>
<td align="left"><code>[ep-1 foo bar]</code></td>
</tr>
<tr>
<td align="left"><code>[/ep-1]</code></td>
<td align="left"><code>[foo bar]</code></td>
<td align="left"><code>[/ep-2]</code></td>
<td align="left"><not set></td>
<td align="left"><code>[ep-2]</code></td>
</tr>
<tr>
<td align="left"><code>[/ep-1]</code></td>
<td align="left"><code>[foo bar]</code></td>
<td align="left"><not set></td>
<td align="left"><code>[zoo boo]</code></td>
<td align="left"><code>[ep-1 zoo boo]</code></td>
</tr>
<tr>
<td align="left"><code>[/ep-1]</code></td>
<td align="left"><code>[foo bar]</code></td>
<td align="left"><code>[/ep-2]</code></td>
<td align="left"><code>[zoo boo]</code></td>
<td align="left"><code>[ep-2 zoo boo]</code></td>
</tr>
</tbody>
</table>
<h3 id="lifecycle">Lifecycle</h3>
<p>定义了Container Lifecycle Hooks，即容器状态发生变化时触发的一系列钩子</p>
<div class="hlcode"><pre><span class="n">apiVersion</span><span class="o">:</span> <span class="n">v1</span>
<span class="n">kind</span><span class="o">:</span> <span class="n">Pod</span>
<span class="n">metadata</span><span class="o">:</span>
  <span class="n">name</span><span class="o">:</span> <span class="n">lifecycle</span><span class="o">-</span><span class="n">demo</span>
<span class="n">spec</span><span class="o">:</span>
  <span class="n">containers</span><span class="o">:</span>
  <span class="o">-</span> <span class="n">name</span><span class="o">:</span> <span class="n">lifecycle</span><span class="o">-</span><span class="n">demo</span><span class="o">-</span><span class="n">container</span>
    <span class="n">image</span><span class="o">:</span> <span class="n">nginx</span>
    <span class="n">lifecycle</span><span class="o">:</span>
      <span class="n">postStart</span><span class="o">:</span>
        <span class="n">exec</span><span class="o">:</span>
          <span class="n">command</span><span class="o">:</span> <span class="o">[</span><span class="s2">&quot;/bin/sh&quot;</span><span class="o">,</span> <span class="s2">&quot;-c&quot;</span><span class="o">,</span> <span class="s2">&quot;echo Hello from the postStart handler &gt; /usr/share/message&quot;</span><span class="o">]</span>
      <span class="n">preStop</span><span class="o">:</span>
        <span class="n">exec</span><span class="o">:</span>
          <span class="n">command</span><span class="o">:</span> <span class="o">[</span><span class="s2">&quot;/usr/sbin/nginx&quot;</span><span class="o">,</span><span class="s2">&quot;-s&quot;</span><span class="o">,</span><span class="s2">&quot;quit&quot;</span><span class="o">]</span>
</pre></div>


<h4 id="poststart-object">postStart   <code>&lt;Object&gt;</code></h4>
<p>指在容器启动后，立刻执行一个指定的操作</p>
<p>若postStart执行超时或者错误，Kubernetes会在该Pod的Events中报出该容器启动失败的错误信息，导致Pod也处于失败的状态</p>
<h5 id="exec-object">exec <code>&lt;Object&gt;</code> 用户指定命令</h5>
<p>根据指令返回码判断</p>
<div class="hlcode"><pre><span class="n">apiVersion</span><span class="o">:</span> <span class="n">v1</span>
<span class="n">kind</span><span class="o">:</span> <span class="n">Pod</span>
<span class="n">metadata</span><span class="o">:</span>
  <span class="n">name</span><span class="o">:</span> <span class="n">poststart</span><span class="o">-</span><span class="n">pod</span>
  <span class="kd">namespace</span><span class="o">:</span> <span class="k">default</span>
<span class="n">spec</span><span class="o">:</span>
  <span class="n">containers</span><span class="o">:</span>
  <span class="o">-</span> <span class="n">name</span><span class="o">:</span> <span class="n">busybox</span><span class="o">-</span><span class="n">httpd</span>
    <span class="n">image</span><span class="o">:</span> <span class="n">busybox</span><span class="o">:</span><span class="n">latest</span>
    <span class="n">imagePullPolicy</span><span class="o">:</span> <span class="n">IfNotPresent</span>
    <span class="n">lifecycle</span><span class="o">:</span>
      <span class="n">postStart</span><span class="o">:</span>
        <span class="n">exec</span><span class="o">:</span>
          <span class="n">command</span><span class="o">:</span> <span class="o">[</span><span class="s1">&#39;mkdir&#39;</span><span class="o">,</span> <span class="s1">&#39;-p&#39;</span><span class="o">,</span> <span class="s1">&#39;/data/web/html&#39;</span><span class="o">]</span>
    <span class="n">command</span><span class="o">:</span> <span class="o">[</span><span class="s1">&#39;/bin/sh&#39;</span><span class="o">,</span> <span class="s1">&#39;-c&#39;</span><span class="o">,</span> <span class="s1">&#39;sleep 3600&#39;</span><span class="o">]</span>
</pre></div>


<h5 id="httpget-object">httpGet      <code>&lt;Object&gt;</code></h5>
<p>Pod 其实可以暴露一个健康检查 URL(比如 /healthz)，或者直接让健康检查去检测 应用的监听端口</p>
<div class="hlcode"><pre>
</pre></div>


<h5 id="tcpsocket-object">tcpSocket    <code>&lt;Object&gt;</code></h5>
<p>Pod 其实可以暴露一个健康检查 URL(比如 /healthz)，或者直接让健康检查去检测 应用的监听端口</p>
<h4 id="prestop-object">preStop     <code>&lt;Object&gt;</code> 终止前</h4>
<p>指容器被杀死之前，执行的操作</p>
<p>由于是同步的，会阻塞之前的容器杀死流程，直到这个Hook定义的操作完成之后，才允许容器被杀死</p>
<h5 id="exec-object_1">exec <code>&lt;Object&gt;</code> 用户指定命令</h5>
<p>根据指令返回码判断</p>
<h5 id="httpget-object_1">httpGet      <code>&lt;Object&gt;</code></h5>
<p>Pod 其实可以暴露一个健康检查 URL(比如 /healthz)，或者直接让健康检查去检测 应用的监听端口</p>
<h5 id="tcpsocket-object_1">tcpSocket    <code>&lt;Object&gt;</code></h5>
<p>Pod 其实可以暴露一个健康检查 URL(比如 /healthz)，或者直接让健康检查去检测 应用的监听端口</p>
<h3 id="livenessprobe">livenessProbe</h3>
<h4 id="exec">exec</h4>
<p>exec类型探针通过在目标容器中执行由用户自定义的命令来判断容器的健康状态</p>
<p>返回0表示成功，其他均为失败</p>
<div class="hlcode"><pre><span class="n">apiVersion</span><span class="o">:</span> <span class="n">v1</span>
<span class="n">kind</span><span class="o">:</span> <span class="n">Pod</span>
<span class="n">metadata</span><span class="o">:</span>
  <span class="n">labels</span><span class="o">:</span>
    <span class="n">test</span><span class="o">:</span> <span class="n">liveness</span><span class="o">-</span><span class="n">exec</span>
  <span class="n">name</span><span class="o">:</span> <span class="n">liveness</span><span class="o">-</span><span class="n">exec</span>
<span class="n">spec</span><span class="o">:</span> 
  <span class="n">containers</span><span class="o">:</span>
  <span class="o">-</span> <span class="n">name</span><span class="o">:</span> <span class="n">liveness</span><span class="o">-</span><span class="n">exec</span><span class="o">-</span><span class="n">demo</span>
    <span class="n">image</span><span class="o">:</span> <span class="n">busybox</span>
    <span class="n">args</span><span class="o">:</span> <span class="o">[</span><span class="s2">&quot;/bin/sh&quot;</span><span class="o">,</span> <span class="s2">&quot;-c&quot;</span><span class="o">,</span> <span class="s2">&quot;touch /tmp/healthy; sleep 60; rm -rf /tmp/healthy; sleep 600;&quot;</span><span class="o">]</span>
    <span class="n">livenessProbe</span><span class="o">:</span>
      <span class="n">exec</span><span class="o">:</span>
        <span class="n">command</span><span class="o">:</span> <span class="o">[</span><span class="s2">&quot;test&quot;</span><span class="o">,</span> <span class="s2">&quot;-e&quot;</span><span class="o">,</span> <span class="s2">&quot;/tmp/healthy&quot;</span><span class="o">]</span>
</pre></div>


<h4 id="httpget">httpGet</h4>
<p>向目标容器发起一个http请求，根据响应状态码进行结果盘点</p>
<p>2xx 或3xx表示通过</p>
<div class="hlcode"><pre><span class="n">apiVersion</span><span class="o">:</span> <span class="n">v1</span>
<span class="n">kind</span><span class="o">:</span> <span class="n">Pod</span>
<span class="n">metadata</span><span class="o">:</span>
  <span class="n">labels</span><span class="o">:</span>
    <span class="n">test</span><span class="o">:</span> <span class="n">liveness</span>
  <span class="n">name</span><span class="o">:</span> <span class="n">liveness</span><span class="o">-</span><span class="n">http</span>
<span class="n">spec</span><span class="o">:</span>
  <span class="n">containers</span><span class="o">:</span>
    <span class="o">-</span> <span class="n">name</span><span class="o">:</span> <span class="n">liveness</span><span class="o">-</span><span class="n">http</span><span class="o">-</span><span class="n">demo</span>
      <span class="n">image</span><span class="o">:</span> <span class="n">nginx</span><span class="o">:</span><span class="mf">1.12</span><span class="o">-</span><span class="n">alpine</span>
      <span class="n">ports</span><span class="o">:</span>
      <span class="o">-</span> <span class="n">name</span><span class="o">:</span> <span class="n">http</span>
        <span class="n">containersPort</span><span class="o">:</span> <span class="mi">80</span>
      <span class="n">lifecycle</span><span class="o">:</span>
        <span class="n">portStart</span><span class="o">:</span>
          <span class="n">exec</span><span class="o">:</span>
            <span class="n">command</span><span class="o">:</span> <span class="o">[</span><span class="s2">&quot;/bin/sh&quot;</span><span class="o">,</span> <span class="s2">&quot;-c&quot;</span><span class="o">,</span> <span class="s2">&quot;echo Healthy &gt; /usr/share/nginx/html/healthz&quot;</span><span class="o">]</span>
      <span class="n">livenessProbe</span><span class="o">:</span>
        <span class="n">httpGet</span><span class="o">:</span>
          <span class="n">path</span><span class="o">:</span> <span class="o">/</span><span class="n">healthz</span>
          <span class="n">port</span><span class="o">:</span> <span class="n">http</span>
          <span class="n">scheme</span><span class="o">:</span> <span class="n">HTTP</span>
</pre></div>


<h4 id="tcpsocket">tcpSocket</h4>
<p>基于TCP的存活性探测(TCPSocketAction) 向容器的特定端口发起TCP请求并尝试建立连接进行判定</p>
<div class="hlcode"><pre><span class="n">apiVersion</span><span class="o">:</span> <span class="n">v1</span>
<span class="n">kind</span><span class="o">:</span> <span class="n">Pod</span>
<span class="n">metadata</span><span class="o">:</span>
  <span class="n">labels</span><span class="o">:</span>
    <span class="n">test</span><span class="o">:</span> <span class="n">liveness</span>
  <span class="n">name</span><span class="o">:</span> <span class="n">liveness</span><span class="o">-</span><span class="n">tcp</span>
<span class="n">spec</span><span class="o">:</span>
  <span class="n">containers</span><span class="o">:</span>
    <span class="o">-</span> <span class="n">name</span><span class="o">:</span> <span class="n">liveness</span><span class="o">-</span><span class="n">tcp</span><span class="o">-</span><span class="n">demo</span>
      <span class="n">image</span><span class="o">:</span> <span class="n">nginx</span><span class="o">:</span><span class="mf">1.12</span><span class="o">-</span><span class="n">alpine</span>
      <span class="n">ports</span><span class="o">:</span>
      <span class="o">-</span> <span class="n">name</span><span class="o">:</span> <span class="n">http</span>
        <span class="n">containersPort</span><span class="o">:</span> <span class="mi">80</span>
      <span class="n">livenessProbe</span><span class="o">:</span>
        <span class="n">tcpSocket</span><span class="o">:</span>
          <span class="n">port</span><span class="o">:</span> <span class="n">http</span>
</pre></div>


<h3 id="readinessprobe">readinessProbe</h3>
<p>虽然它的用法与 livenessProbe 类似，但作用却大不一样。readinessProbe 检查结果的成功与否，决定的这个 Pod 是不是能被通 过 Service 的方式访问到，而并不影响 Pod 的生命周期</p>
<h2 id="selector">selector</h2>
<h3 id="matchlabels-label-selector">matchLabels （Label Selector）</h3>
<p>通过直接给定键值来指定标签选择器</p>
<div class="hlcode"><pre><span class="n">selector</span><span class="o">:</span>
  <span class="n">matchLabels</span><span class="o">:</span>
    <span class="n">component</span><span class="o">:</span> <span class="n">redis</span>
</pre></div>


<h3 id="matchexpressions">matchExpressions</h3>
<p>基于表达式指定的标签选择器列表，每个选择器都形如</p>
<div class="hlcode"><pre><span class="p">{</span><span class="n">key</span><span class="o">:</span> <span class="n">KEY_NAME</span><span class="p">,</span> <span class="n">operator</span><span class="o">:</span> <span class="n">OPERATOR</span><span class="p">,</span> <span class="n">values</span><span class="o">:</span> <span class="p">[</span><span class="n">VALUE1</span><span class="p">,</span> <span class="n">VALUE2</span><span class="p">,</span> <span class="p">...]}</span>
</pre></div>


<div class="hlcode"><pre><span class="n">selector</span><span class="o">:</span>
  <span class="n">matchExpressions</span><span class="o">:</span>
    <span class="o">-</span> <span class="o">{</span><span class="n">key</span><span class="o">:</span> <span class="n">tier</span><span class="o">,</span> <span class="n">operator</span><span class="o">:</span> <span class="n">In</span><span class="o">,</span> <span class="n">values</span><span class="o">:</span> <span class="o">[</span><span class="n">cache</span><span class="o">]}</span>
    <span class="o">-</span> <span class="o">{</span><span class="n">key</span><span class="o">:</span> <span class="n">environment</span><span class="o">,</span> <span class="n">operator</span><span class="o">:</span> <span class="n">Exists</span><span class="o">,</span> <span class="n">values</span><span class="o">:}</span>
</pre></div>


<h2 id="nodeselector-deprecated-by-nodeaffinity">nodeSelector (Deprecated by nodeAffinity)</h2>
<p>nodeSelector 其实已经是一个将要被废弃的字段了</p>
<p>供用户将Pod与Node进行绑定的字段</p>
<div class="hlcode"><pre><span class="n">apiVersion</span><span class="o">:</span> <span class="n">v1</span>
<span class="n">kind</span><span class="o">:</span> <span class="n">Pod</span>
<span class="o">...</span>
<span class="n">spec</span><span class="o">:</span>
 <span class="n">nodeSelector</span><span class="o">:</span>
   <span class="n">disktype</span><span class="o">:</span> <span class="n">ssd</span>
</pre></div>


<blockquote>
<p>这样意味着Pod只能运行在携带disktype： ssd标签的节点上，否则将调度失败</p>
</blockquote>
<p>调度某些资源至指定设备节点，使用nodeSelector选择器</p>
<div class="hlcode"><pre><span class="n">apiVersion</span><span class="o">:</span> <span class="n">v1</span>
<span class="n">kind</span><span class="o">:</span> <span class="n">Pod</span>
<span class="n">metadata</span><span class="o">:</span>
  <span class="n">name</span><span class="o">:</span> <span class="n">pod</span><span class="o">-</span><span class="k">with</span><span class="o">-</span><span class="n">nodeselector</span>
  <span class="n">labels</span><span class="o">:</span>
    <span class="n">env</span><span class="o">:</span> <span class="n">testing</span>
<span class="n">spec</span><span class="o">:</span> 
  <span class="n">containers</span><span class="o">:</span>
  <span class="o">-</span> <span class="n">name</span><span class="o">:</span> <span class="n">myapp</span>
    <span class="n">image</span><span class="o">:</span> <span class="n">ikubernetes</span><span class="o">/</span><span class="n">myapp</span><span class="o">:</span><span class="n">v1</span>
  <span class="n">nodeSelector</span><span class="o">:</span>
    <span class="n">disktype</span><span class="o">:</span> <span class="n">ssd</span>
</pre></div>


<h2 id="nodename">nodeName</h2>
<p>一旦 Pod 的这个字段被赋值，Kubernetes 项目就会被认为这个 Pod 已经经过了调度，调度的结果就是赋值的节点名字。所以，这个字段一般由调度器负责设置，但用户也可以设置它来“骗过”调度器，当然这个做法一般是在测试或者调试的时候才会用到。</p>
<p>即直接运行在指定节点上</p>
<h2 id="nodeaffinity">nodeAffinity</h2>
<p>spec.affinity字段，是Pod里跟调度相关的一个字段</p>
<div class="hlcode"><pre><span class="n">apiVersion</span><span class="o">:</span> <span class="n">v1</span>
<span class="n">kind</span><span class="o">:</span> <span class="n">Pod</span>
<span class="n">metadata</span><span class="o">:</span>
  <span class="n">name</span><span class="o">:</span> <span class="k">with</span><span class="o">-</span><span class="n">node</span><span class="o">-</span><span class="n">affinity</span>
<span class="n">spec</span><span class="o">:</span>
  <span class="n">affinity</span><span class="o">:</span>
    <span class="n">nodeAffinity</span><span class="o">:</span>
      <span class="n">requiredDuringSchedulingIgnoredDuringExecution</span><span class="o">:</span>
        <span class="n">nodeSelectorTerms</span><span class="o">:</span>
        <span class="o">-</span> <span class="n">matchExpressions</span><span class="o">:</span>
          <span class="o">-</span> <span class="n">key</span><span class="o">:</span> <span class="n">metadata</span><span class="o">.</span><span class="na">name</span>
            <span class="n">operator</span><span class="o">:</span> <span class="n">In</span>
            <span class="n">values</span><span class="o">:</span>
            <span class="o">-</span> <span class="n">node</span><span class="o">-</span><span class="n">geektime</span>
</pre></div>


<blockquote>
<p>requiredDuringSchedulingIgnoredDuringExecution    指这个nodeAffinity必须在每次调度的时候予以考虑，也表示可以在设置某些情况下不考虑这个nodeAffinity</p>
<p>当前Pod只会运行在metadata.name 是 node-geektime上面节点运行</p>
</blockquote>
<div class="hlcode"><pre><span class="n">apiVersion</span><span class="o">:</span> <span class="n">v1</span>
<span class="n">kind</span><span class="o">:</span> <span class="n">Pod</span>
<span class="n">metadata</span><span class="o">:</span>
  <span class="n">name</span><span class="o">:</span> <span class="k">with</span><span class="o">-</span><span class="n">toleration</span>
<span class="n">spec</span><span class="o">:</span>
  <span class="n">tolerations</span><span class="o">:</span>
  <span class="o">-</span> <span class="n">key</span><span class="o">:</span> <span class="n">node</span><span class="o">.</span><span class="na">kubernetes</span><span class="o">.</span><span class="na">io</span><span class="o">/</span><span class="n">unschedulable</span>
    <span class="n">operator</span><span class="o">:</span> <span class="n">Exists</span>
    <span class="n">effect</span><span class="o">:</span> <span class="n">NoSchedule</span>
</pre></div>


<blockquote>
<p>Toleration容忍”所有被标记为 unschedulable“污点”的 Node；“容忍”的效果是允许调度。</p>
</blockquote>
<h2 id="sessionaffinity">sessionAffinity</h2>
<p>None表示不启用，随机请求后端Pod</p>
<p>ClientIP表示锁定一个后端请求,即访问同一个Pod资源</p>
<div class="hlcode"><pre><span class="cp"># Please edit the object below. Lines beginning with a &#39;#&#39; will be ignored,</span>
<span class="cp"># and an empty file will abort the edit. If an error occurs while saving this file will be</span>
<span class="cp"># reopened with the relevant failures.</span>
<span class="cp">#</span>
<span class="nl">apiVersion:</span> <span class="n">v1</span>
<span class="nl">kind:</span> <span class="n">Service</span>
<span class="nl">metadata:</span>
  <span class="nl">annotations:</span>
    <span class="n">kubectl</span><span class="p">.</span><span class="n">kubernetes</span><span class="p">.</span><span class="n">io</span><span class="o">/</span><span class="n">last</span><span class="o">-</span><span class="n">applied</span><span class="o">-</span><span class="n">configuration</span><span class="o">:</span> <span class="o">|</span>
      <span class="p">{</span><span class="s">&quot;apiVersion&quot;</span><span class="o">:</span><span class="s">&quot;v1&quot;</span><span class="p">,</span><span class="s">&quot;kind&quot;</span><span class="o">:</span><span class="s">&quot;Service&quot;</span><span class="p">,</span><span class="s">&quot;metadata&quot;</span><span class="o">:</span><span class="p">{</span><span class="s">&quot;annotations&quot;</span><span class="o">:</span><span class="p">{},</span><span class="s">&quot;name&quot;</span><span class="o">:</span><span class="s">&quot;myapp&quot;</span><span class="p">,</span><span class="s">&quot;namespace&quot;</span><span class="o">:</span><span class="s">&quot;default&quot;</span><span class="p">},</span><span class="s">&quot;spec&quot;</span><span class="o">:</span><span class="p">{</span><span class="s">&quot;clusterIP&quot;</span><span class="o">:</span><span class="s">&quot;10.99.99.99&quot;</span><span class="p">,</span><span class="s">&quot;ports&quot;</span><span class="o">:</span><span class="p">[{</span><span class="s">&quot;nodePort&quot;</span><span class="o">:</span><span class="mi">30080</span><span class="p">,</span><span class="s">&quot;port&quot;</span><span class="o">:</span><span class="mi">80</span><span class="p">,</span><span class="s">&quot;targetPort&quot;</span><span class="o">:</span><span class="mi">80</span><span class="p">}],</span><span class="s">&quot;selector&quot;</span><span class="o">:</span><span class="p">{</span><span class="s">&quot;app&quot;</span><span class="o">:</span><span class="s">&quot;myapp&quot;</span><span class="p">,</span><span class="s">&quot;release&quot;</span><span class="o">:</span><span class="s">&quot;canary&quot;</span><span class="p">},</span><span class="s">&quot;type&quot;</span><span class="o">:</span><span class="s">&quot;NodePort&quot;</span><span class="p">}}</span>
  <span class="nl">creationTimestamp:</span> <span class="s">&quot;2019-04-07T05:54:38Z&quot;</span>
  <span class="nl">name:</span> <span class="n">myapp</span>
  <span class="nl">namespace:</span> <span class="k">default</span>
  <span class="nl">resourceVersion:</span> <span class="s">&quot;739917&quot;</span>
  <span class="nl">selfLink:</span> <span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">v1</span><span class="o">/</span><span class="n">namespaces</span><span class="o">/</span><span class="k">default</span><span class="o">/</span><span class="n">services</span><span class="o">/</span><span class="n">myapp</span>
  <span class="nl">uid:</span> <span class="n">a1636d2f</span><span class="o">-</span><span class="mf">58f</span><span class="mi">9</span><span class="o">-</span><span class="mf">11e9</span><span class="o">-</span><span class="mi">8178</span><span class="o">-</span><span class="mf">560001f</span><span class="n">a0d25</span>
<span class="nl">spec:</span>
  <span class="nl">clusterIP:</span> <span class="mf">10.99.99.99</span>
  <span class="nl">externalTrafficPolicy:</span> <span class="n">Cluster</span>
  <span class="nl">ports:</span>
  <span class="o">-</span> <span class="n">nodePort</span><span class="o">:</span> <span class="mi">30080</span>
    <span class="nl">port:</span> <span class="mi">80</span>
    <span class="nl">protocol:</span> <span class="n">TCP</span>
    <span class="nl">targetPort:</span> <span class="mi">80</span>
  <span class="nl">selector:</span>
    <span class="nl">app:</span> <span class="n">myapp</span>
    <span class="nl">release:</span> <span class="n">canary</span>
  <span class="nl">sessionAffinity:</span> <span class="n">None</span>
  <span class="nl">type:</span> <span class="n">NodePort</span>
<span class="nl">status:</span>
  <span class="nl">loadBalancer:</span> <span class="p">{}</span>
</pre></div>


<h2 id="hostaliases">hostAliases</h2>
<p>定义了 Pod 的 hosts 文件（比如 /etc/hosts）里的内容</p>
<div class="hlcode"><pre><span class="n">apiVersion</span><span class="o">:</span> <span class="n">v1</span>
<span class="n">kind</span><span class="o">:</span> <span class="n">Pod</span>
<span class="o">...</span>
<span class="n">spec</span><span class="o">:</span>
  <span class="n">hostAliases</span><span class="o">:</span>
  <span class="o">-</span> <span class="n">ip</span><span class="o">:</span> <span class="s2">&quot;10.1.2.3&quot;</span>
    <span class="n">hostnames</span><span class="o">:</span>
    <span class="o">-</span> <span class="s2">&quot;foo.remote&quot;</span>
    <span class="o">-</span> <span class="s2">&quot;bar.remote&quot;</span>
<span class="o">...</span>
</pre></div>


<p>以上面的配置，Pod启动后，/etc/hosts文件会如下</p>
<div class="hlcode"><pre><span class="n">cat</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">hosts</span>
<span class="cp"># Kubernetes-managed hosts file.</span>
<span class="mf">127.0.0.1</span> <span class="n">localhost</span>
<span class="p">...</span>
<span class="mf">10.244.135.10</span> <span class="n">hostaliases</span><span class="o">-</span><span class="n">pod</span>
<span class="mf">10.1.2.3</span> <span class="n">foo</span><span class="p">.</span><span class="n">remote</span>
<span class="mf">10.1.2.3</span> <span class="n">bar</span><span class="p">.</span><span class="n">remote</span>
</pre></div>


<p>在 Kubernetes 项目中，如果要设置 hosts 文件里的内容，一定要通过这种方法。否则，如果直接修改了 hosts 文件的话，在 Pod 被删除重建之后，kubelet 会自动覆盖掉被修改的内容。</p>
<h2 id="hostnetworkhostipchostpid">hostNetwork/hostIPC/hostPID</h2>
<p>在Pod中的容器要共享宿主机的Namespace，也一定是pod级别定义的</p>
<div class="hlcode"><pre><span class="n">apiVersion</span><span class="o">:</span> <span class="n">v1</span>
<span class="n">kind</span><span class="o">:</span> <span class="n">Pod</span>
<span class="n">metadata</span><span class="o">:</span>
  <span class="n">name</span><span class="o">:</span> <span class="n">nginx</span>
<span class="n">spec</span><span class="o">:</span>
  <span class="n">hostNetwork</span><span class="o">:</span> <span class="kc">true</span>
  <span class="n">hostIPC</span><span class="o">:</span> <span class="kc">true</span>
  <span class="n">hostPID</span><span class="o">:</span> <span class="kc">true</span>
  <span class="n">containers</span><span class="o">:</span>
  <span class="o">-</span> <span class="n">name</span><span class="o">:</span> <span class="n">nginx</span>
    <span class="n">image</span><span class="o">:</span> <span class="n">nginx</span>
  <span class="o">-</span> <span class="n">name</span><span class="o">:</span> <span class="n">shell</span>
    <span class="n">image</span><span class="o">:</span> <span class="n">busybox</span>
    <span class="n">stdin</span><span class="o">:</span> <span class="kc">true</span>
    <span class="n">tty</span><span class="o">:</span> <span class="kc">true</span>
</pre></div>


<blockquote>
<p>这个Pod里面的所有容器，都会直接使用宿主机的网络，直接与IPC进行通信，以及看到宿主机正在运行的所有进程</p>
</blockquote>
<h2 id="shareprocessnamespace">shareProcessNamespace</h2>
<p>Pod 里面的容器要共享PID Namespace</p>
<div class="hlcode"><pre><span class="n">apiVersion</span><span class="o">:</span> <span class="n">v1</span>
<span class="n">kind</span><span class="o">:</span> <span class="n">Pod</span>
<span class="n">metadata</span><span class="o">:</span>
  <span class="n">name</span><span class="o">:</span> <span class="n">nginx</span>
<span class="n">spec</span><span class="o">:</span>
  <span class="n">shareProcessNamespace</span><span class="o">:</span> <span class="kc">true</span>
  <span class="n">containers</span><span class="o">:</span>
  <span class="o">-</span> <span class="n">name</span><span class="o">:</span> <span class="n">nginx</span>
    <span class="n">image</span><span class="o">:</span> <span class="n">nginx</span>
  <span class="o">-</span> <span class="n">name</span><span class="o">:</span> <span class="n">shell</span>
    <span class="n">image</span><span class="o">:</span> <span class="n">busybox</span>
    <span class="n">stdin</span><span class="o">:</span> <span class="kc">true</span>
    <span class="n">tty</span><span class="o">:</span> <span class="kc">true</span>
</pre></div>


<blockquote>
<p>这个 Pod 被创建后，可以使用 shell 容器的 tty 跟这个容器进行交互了</p>
</blockquote>
<p>可以直接认为 tty 就是 Linux 给用户提供的一个常驻小程 序，用于接收用户的标准输入，返回操作系统的标准输出。当然，为了能够在 tty 中输入信息, 还需要同时开启 stdin(标准输入流)。</p>
<div class="hlcode"><pre><span class="err">$</span> <span class="n">kubectl</span> <span class="n">create</span> <span class="o">-</span><span class="n">f</span> <span class="n">nginx</span><span class="p">.</span><span class="n">yaml</span>
<span class="err">$</span> <span class="n">kubectl</span> <span class="n">attach</span> <span class="o">-</span><span class="n">it</span> <span class="n">nginx</span> <span class="o">-</span><span class="n">c</span> <span class="n">shell</span>
<span class="o">/</span> <span class="err">#</span> <span class="n">ps</span> <span class="n">ef</span>
<span class="n">PID</span>   <span class="n">USER</span>     <span class="n">TIME</span>  <span class="n">COMMAND</span>
    <span class="mi">1</span> <span class="n">root</span>      <span class="mi">0</span><span class="o">:</span><span class="mo">00</span> <span class="o">/</span><span class="n">pause</span>
    <span class="mi">6</span> <span class="n">root</span>      <span class="mi">0</span><span class="o">:</span><span class="mo">00</span> <span class="n">nginx</span><span class="o">:</span> <span class="n">master</span> <span class="n">process</span> <span class="n">nginx</span> <span class="o">-</span><span class="n">g</span> <span class="n">daemon</span> <span class="n">off</span><span class="p">;</span>
   <span class="mi">12</span> <span class="mi">101</span>       <span class="mi">0</span><span class="o">:</span><span class="mo">00</span> <span class="n">nginx</span><span class="o">:</span> <span class="n">worker</span> <span class="n">process</span>
   <span class="mi">13</span> <span class="n">root</span>      <span class="mi">0</span><span class="o">:</span><span class="mo">00</span> <span class="n">sh</span>
   <span class="mi">18</span> <span class="n">root</span>      <span class="mi">0</span><span class="o">:</span><span class="mo">00</span> <span class="n">ps</span> <span class="n">ef</span>
</pre></div>


<h2 id="restartpolicy">restartPolicy</h2>
<p>Kubernetes 里的Pod 恢复机制，默认值是 Always，即:任何时候这个容器发生了异常，它 一定会被重新创建。</p>
<p>Pod 的恢复过程，永远都是发生在当前节点上，而不会跑到别的节点上去。事 实上，一旦一个 Pod 与一个节点(Node)绑定，除非这个绑定发生了变化(pod.spec.node 字段 被修改)，否则它永远都不会离开这个节点。</p>
<h3 id="_2">恢复策略</h3>
<p>Always:在任何情况下，只要容器不在运行状态，就自动重启容器</p>
<p>OnFailure: 只在容器 异常时才自动重启容器</p>
<p>Never: 从来不重启容器</p>
<p>如果你要关心这个容器退出后的上下文环境，比如容器退出后的日志、文件和目录，就需要将 restartPolicy 设置为 Never。因为一旦容器被自动重新创建，这些内容就有可能丢失掉了(被垃圾 回收了)。</p>
<h3 id="_3">恢复原理</h3>
<ol>
<li>只要 Pod 的 restartPolicy 指定的策略允许重启异常的容器(比如:Always)，那么这个 Pod 就会保持 Running 状态，并进行容器重启。否则，Pod 就会进入 Failed 状态 。</li>
<li>对于包含多个容器的 Pod，只有它里面所有的容器都进入异常状态后，Pod 才会进入 Failed 状 态。在此之前，Pod 都是 Running 状态。此时，Pod 的 READY 字段会显示正常容器的个数</li>
</ol>
<h1 id="status-read-only">status 当前状态 (read-only)</h1>
<p>显示目标资源的当前状态</p>
<p>由kubernetes集群维护，用户不能自定义</p>
<p>即status状态尽最大向spec状态转移</p>
<h2 id="activedeadlineseconds">activeDeadlineSeconds</h2>
<p>设置最长运行时间</p>
<div class="hlcode"><pre><span class="n">spec</span><span class="o">:</span>
 <span class="n">backoffLimit</span><span class="o">:</span> <span class="mi">5</span>
 <span class="n">activeDeadlineSeconds</span><span class="o">:</span> <span class="mi">100</span>
</pre></div>


<blockquote>
<p>这是Job对象的例子</p>
</blockquote>
<h2 id="parallelism">parallelism</h2>
<p>它定义的是一个 Job 在任意时间最多可以启动多少个 Pod 同时运行</p>
<h2 id="completions">completions</h2>
<p>它定义的是 Job 至少要完成的 Pod 数目，即 Job 的最小完成数</p>
<h2 id="rollingupdatestrategy">RollingUpdateStrategy</h2>
<p>Deployment 对象的一个字段</p>
<div class="hlcode"><pre><span class="n">apiVersion</span><span class="o">:</span> <span class="n">apps</span><span class="o">/</span><span class="n">v1</span>
<span class="n">kind</span><span class="o">:</span> <span class="n">Deployment</span>
<span class="n">metadata</span><span class="o">:</span>
  <span class="n">name</span><span class="o">:</span> <span class="n">nginx</span><span class="o">-</span><span class="n">deployment</span>
  <span class="n">labels</span><span class="o">:</span>
    <span class="n">app</span><span class="o">:</span> <span class="n">nginx</span>
<span class="n">spec</span><span class="o">:</span>
<span class="o">...</span>
  <span class="n">strategy</span><span class="o">:</span>
    <span class="n">type</span><span class="o">:</span> <span class="n">RollingUpdate</span>
    <span class="n">rollingUpdate</span><span class="o">:</span>
      <span class="n">maxSurge</span><span class="o">:</span> <span class="mi">1</span>
      <span class="n">maxUnavailable</span><span class="o">:</span> <span class="mi">1</span>
</pre></div>


<blockquote>
<p>maxSurge 指除了DESIRED数量之外，在一次滚动中，Deployment控制器还可以创建多少个新的Pod</p>
<p>maxUnavailable 指在一次滚动更细腻中，Deployment 控制器可以删除多少个旧Pod</p>
</blockquote>
<h2 id="revisionhistorylimit">revisionHistoryLimit</h2>
<p>为Deployment保留的历史版本个数</p>
<p>设置为0，表示再也不能做滚动更新操作了</p>
<h2 id="volumeclaimtemplates">volumeClaimTemplates</h2>
<p>被StatefulSet管理的Pod，都会声明一个对应的PVC</p>
<p>PVC的定义，源自于volumeClaimTemplates的模板字段</p>
<div class="hlcode"><pre><span class="n">apiVersion</span><span class="o">:</span> <span class="n">apps</span><span class="o">/</span><span class="n">v1</span>
<span class="n">kind</span><span class="o">:</span> <span class="n">StatefulSet</span>
<span class="n">metadata</span><span class="o">:</span>
  <span class="n">name</span><span class="o">:</span> <span class="n">web</span>
<span class="n">spec</span><span class="o">:</span>
  <span class="n">serviceName</span><span class="o">:</span> <span class="s2">&quot;nginx&quot;</span>
  <span class="n">replicas</span><span class="o">:</span> <span class="mi">2</span>
  <span class="n">selector</span><span class="o">:</span>
    <span class="n">matchLabels</span><span class="o">:</span>
      <span class="n">app</span><span class="o">:</span> <span class="n">nginx</span>
  <span class="n">template</span><span class="o">:</span>
    <span class="n">metadata</span><span class="o">:</span>
      <span class="n">labels</span><span class="o">:</span>
        <span class="n">app</span><span class="o">:</span> <span class="n">nginx</span>
    <span class="n">spec</span><span class="o">:</span>
      <span class="n">containers</span><span class="o">:</span>
      <span class="o">-</span> <span class="n">name</span><span class="o">:</span> <span class="n">nginx</span>
        <span class="n">image</span><span class="o">:</span> <span class="n">nginx</span><span class="o">:</span><span class="mf">1.9</span><span class="o">.</span><span class="mi">1</span>
        <span class="n">ports</span><span class="o">:</span>
        <span class="o">-</span> <span class="n">containerPort</span><span class="o">:</span> <span class="mi">80</span>
          <span class="n">name</span><span class="o">:</span> <span class="n">web</span>
        <span class="n">volumeMounts</span><span class="o">:</span>
        <span class="o">-</span> <span class="n">name</span><span class="o">:</span> <span class="n">www</span>
          <span class="n">mountPath</span><span class="o">:</span> <span class="sr">/usr/share/nginx/</span><span class="n">html</span>
  <span class="n">volumeClaimTemplates</span><span class="o">:</span>
  <span class="o">-</span> <span class="n">metadata</span><span class="o">:</span>
      <span class="n">name</span><span class="o">:</span> <span class="n">www</span>
    <span class="n">spec</span><span class="o">:</span>
      <span class="n">accessModes</span><span class="o">:</span>
      <span class="o">-</span> <span class="n">ReadWriteOnce</span>
      <span class="n">resources</span><span class="o">:</span>
        <span class="n">requests</span><span class="o">:</span>
          <span class="n">storage</span><span class="o">:</span> <span class="mi">1</span><span class="n">Gi</span>
</pre></div>
    </div>
    <div id="footer">
      <span>
        <p>Copyright © 2020 Xu XueHua.
        Powered by <a href="http://simiki.org/" target="_blank">Simiki</a>.</p>
        <p>Site Generated 2020-12-12 14:54:32</p>
      </span>
    </div>

    
    
  </body>
</html>