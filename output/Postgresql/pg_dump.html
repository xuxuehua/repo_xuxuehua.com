<!DOCTYPE HTML>
<html>
  <head>
    <link rel="Stylesheet" type="text/css" href="/static/css/style.css">
    <link rel="Stylesheet" type="text/css" href="/static/css/tango.css">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="alternate" type="application/atom+xml" href="atom.xml" title="Atom feed">
    <title>pg_dump - Xu XueHua</title>
    <meta name="keywords" content="Xu XueHua"/>
    <meta name="description" content="Xu XueHua's public notes"/>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  </head>

  <body>
    <div id="container">
      
<div id="header">
  <div class="post-nav"><a href="/">Home</a>&nbsp;&#187;&nbsp;<a href="/#Postgresql">Postgresql</a>&nbsp;&#187;&nbsp;pg_dump
    <span class="updated">Page Updated&nbsp;
      2020-09-20 15:46
    </span></div>
</div>
<div class="clearfix"></div>

<div class="page_title">pg_dump</div>

  <p>[toc]</p>
<h1 id="pg_dump">pg_dump</h1>
<h2 id="installation">installation</h2>
<div class="hlcode"><pre><span class="n">sudo</span> <span class="n">tee</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">yum</span><span class="p">.</span><span class="n">repos</span><span class="p">.</span><span class="n">d</span><span class="o">/</span><span class="n">pgdg</span><span class="p">.</span><span class="n">repo</span><span class="o">&lt;&lt;</span><span class="n">EOF</span>
<span class="p">[</span><span class="n">pgdg12</span><span class="p">]</span>
<span class="n">name</span><span class="o">=</span><span class="n">PostgreSQL</span> <span class="mi">12</span> <span class="k">for</span> <span class="n">RHEL</span><span class="o">/</span><span class="n">CentOS</span> <span class="mi">7</span> <span class="o">-</span> <span class="n">x86_64</span>
<span class="n">baseurl</span><span class="o">=</span><span class="n">https</span><span class="o">:</span><span class="c1">//download.postgresql.org/pub/repos/yum/12/redhat/rhel-7-x86_64</span>
<span class="n">enabled</span><span class="o">=</span><span class="mi">1</span>
<span class="n">gpgcheck</span><span class="o">=</span><span class="mi">0</span>
<span class="n">EOF</span>

<span class="n">sudo</span> <span class="n">yum</span> <span class="n">makecache</span>
<span class="n">yum</span> <span class="n">search</span> <span class="n">postgresq</span>
<span class="n">yum</span> <span class="n">install</span> <span class="n">postgresql12</span><span class="p">.</span><span class="n">x86_64</span>

<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">pgsql</span><span class="o">-</span><span class="mi">12</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">psql</span> <span class="o">--</span><span class="n">version</span>
</pre></div>


<p>or </p>
<div class="hlcode"><pre><span class="n">cd</span> <span class="o">/</span><span class="n">tmp</span>
<span class="n">wget</span> <span class="n">https</span><span class="o">:</span><span class="c1">//ftp.postgresql.org/pub/source/v11.4/postgresql-11.4.tar.gz</span>
<span class="n">tar</span> <span class="n">zxvf</span> <span class="n">postgresql</span><span class="o">-</span><span class="mf">11.4</span><span class="p">.</span><span class="n">tar</span><span class="p">.</span><span class="n">gz</span>
<span class="n">cd</span> <span class="n">postgresql</span><span class="o">-</span><span class="mf">11.4</span>
<span class="p">.</span><span class="o">/</span><span class="n">configure</span> <span class="o">--</span><span class="n">without</span><span class="o">-</span><span class="n">readline</span> <span class="o">&amp;&amp;</span> <span class="n">make</span> <span class="o">&amp;&amp;</span> <span class="n">make</span> <span class="n">install</span>
</pre></div>


<blockquote>
<p>By default, it will install pg_dump into <code>/usr/local/pgsql/bin/pg_dump</code></p>
</blockquote>
<h2 id="-s-schema-only">-s, --schema-only</h2>
<p>dump only the schema, no data</p>
<div class="hlcode"><pre><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">pgsql</span><span class="o">-</span><span class="mi">12</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">pg_dump</span> <span class="o">-</span><span class="n">s</span> <span class="o">-</span><span class="n">h</span> <span class="n">rxutestpostgres</span><span class="p">.</span><span class="n">com</span> <span class="o">-</span><span class="n">p</span> <span class="mi">5432</span> <span class="o">-</span><span class="n">U</span> <span class="n">postgres</span> <span class="n">id_generator</span> <span class="o">&gt;</span> <span class="n">abc</span><span class="p">.</span><span class="n">txt</span>
</pre></div>


<div class="hlcode"><pre><span class="err">#</span> <span class="nx">cat</span> <span class="nx">abc</span><span class="p">.</span><span class="nx">txt</span> 
<span class="o">--</span>
<span class="o">--</span> <span class="nx">PostgreSQL</span> <span class="nx">database</span> <span class="nx">dump</span>
<span class="o">--</span>

<span class="o">--</span> <span class="nx">Dumped</span> <span class="nx">from</span> <span class="nx">database</span> <span class="nx">version</span> <span class="mf">12.3</span>
<span class="o">--</span> <span class="nx">Dumped</span> <span class="nx">by</span> <span class="nx">pg_dump</span> <span class="nx">version</span> <span class="mf">12.4</span>

<span class="nx">SET</span> <span class="nx">statement_timeout</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="nx">SET</span> <span class="nx">lock_timeout</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="nx">SET</span> <span class="nx">idle_in_transaction_session_timeout</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="nx">SET</span> <span class="nx">client_encoding</span> <span class="o">=</span> <span class="s1">&#39;UTF8&#39;</span><span class="p">;</span>
<span class="nx">SET</span> <span class="nx">standard_conforming_strings</span> <span class="o">=</span> <span class="nx">on</span><span class="p">;</span>
<span class="nx">SELECT</span> <span class="nx">pg_catalog</span><span class="p">.</span><span class="nx">set_config</span><span class="p">(</span><span class="s1">&#39;search_path&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
<span class="nx">SET</span> <span class="nx">check_function_bodies</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
<span class="nx">SET</span> <span class="nx">xmloption</span> <span class="o">=</span> <span class="nx">content</span><span class="p">;</span>
<span class="nx">SET</span> <span class="nx">client_min_messages</span> <span class="o">=</span> <span class="nx">warning</span><span class="p">;</span>
<span class="nx">SET</span> <span class="nx">row_security</span> <span class="o">=</span> <span class="nx">off</span><span class="p">;</span>

<span class="o">--</span>
<span class="o">--</span> <span class="nx">Name</span><span class="o">:</span> <span class="nx">app_history_id_seq</span><span class="p">;</span> <span class="nx">Type</span><span class="o">:</span> <span class="nx">SEQUENCE</span><span class="p">;</span> <span class="nx">Schema</span><span class="o">:</span> <span class="kr">public</span><span class="p">;</span> <span class="nx">Owner</span><span class="o">:</span> <span class="nx">postgres</span>
<span class="o">--</span>

<span class="nx">CREATE</span> <span class="nx">SEQUENCE</span> <span class="kr">public</span><span class="p">.</span><span class="nx">app_history_id_seq</span>
    <span class="nx">START</span> <span class="nx">WITH</span> <span class="mi">20600000000001</span>
    <span class="nx">INCREMENT</span> <span class="nx">BY</span> <span class="mi">1</span>
    <span class="nx">NO</span> <span class="nx">MINVALUE</span>
    <span class="nx">NO</span> <span class="nx">MAXVALUE</span>
    <span class="nx">CACHE</span> <span class="mi">1</span><span class="p">;</span>


<span class="nx">ALTER</span> <span class="nx">TABLE</span> <span class="kr">public</span><span class="p">.</span><span class="nx">app_history_id_seq</span> <span class="nx">OWNER</span> <span class="nx">TO</span> <span class="nx">postgres</span><span class="p">;</span>

<span class="nx">SET</span> <span class="nx">default_tablespace</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>

<span class="nx">SET</span> <span class="nx">default_table_access_method</span> <span class="o">=</span> <span class="nx">heap</span><span class="p">;</span>

<span class="o">--</span>
<span class="o">--</span> <span class="nx">Name</span><span class="o">:</span> <span class="nx">app_history</span><span class="p">;</span> <span class="nx">Type</span><span class="o">:</span> <span class="nx">TABLE</span><span class="p">;</span> <span class="nx">Schema</span><span class="o">:</span> <span class="kr">public</span><span class="p">;</span> <span class="nx">Owner</span><span class="o">:</span> <span class="nx">postgres</span>
<span class="o">--</span>

<span class="nx">CREATE</span> <span class="nx">TABLE</span> <span class="kr">public</span><span class="p">.</span><span class="nx">app_history</span> <span class="p">(</span>
    <span class="nx">id</span> <span class="nx">bigint</span> <span class="nx">DEFAULT</span> <span class="nx">nextval</span><span class="p">(</span><span class="s1">&#39;public.app_history_id_seq&#39;</span><span class="o">::</span><span class="nx">regclass</span><span class="p">),</span>
    <span class="nx">text_value</span> <span class="nx">text</span>
<span class="p">);</span>


<span class="nx">ALTER</span> <span class="nx">TABLE</span> <span class="kr">public</span><span class="p">.</span><span class="nx">app_history</span> <span class="nx">OWNER</span> <span class="nx">TO</span> <span class="nx">postgres</span><span class="p">;</span>

<span class="o">--</span>
<span class="o">--</span> <span class="nx">Name</span><span class="o">:</span> <span class="nx">statuscode_id_seq</span><span class="p">;</span> <span class="nx">Type</span><span class="o">:</span> <span class="nx">SEQUENCE</span><span class="p">;</span> <span class="nx">Schema</span><span class="o">:</span> <span class="kr">public</span><span class="p">;</span> <span class="nx">Owner</span><span class="o">:</span> <span class="nx">postgres</span>
<span class="o">--</span>

<span class="nx">CREATE</span> <span class="nx">SEQUENCE</span> <span class="kr">public</span><span class="p">.</span><span class="nx">statuscode_id_seq</span>
    <span class="nx">START</span> <span class="nx">WITH</span> <span class="mi">20600000000001</span>
    <span class="nx">INCREMENT</span> <span class="nx">BY</span> <span class="mi">1</span>
    <span class="nx">NO</span> <span class="nx">MINVALUE</span>
    <span class="nx">NO</span> <span class="nx">MAXVALUE</span>
    <span class="nx">CACHE</span> <span class="mi">1</span><span class="p">;</span>


<span class="nx">ALTER</span> <span class="nx">TABLE</span> <span class="kr">public</span><span class="p">.</span><span class="nx">statuscode_id_seq</span> <span class="nx">OWNER</span> <span class="nx">TO</span> <span class="nx">postgres</span><span class="p">;</span>

<span class="o">--</span>
<span class="o">--</span> <span class="nx">Name</span><span class="o">:</span> <span class="nx">statuscode</span><span class="p">;</span> <span class="nx">Type</span><span class="o">:</span> <span class="nx">TABLE</span><span class="p">;</span> <span class="nx">Schema</span><span class="o">:</span> <span class="kr">public</span><span class="p">;</span> <span class="nx">Owner</span><span class="o">:</span> <span class="nx">postgres</span>
<span class="o">--</span>

<span class="nx">CREATE</span> <span class="nx">TABLE</span> <span class="kr">public</span><span class="p">.</span><span class="nx">statuscode</span> <span class="p">(</span>
    <span class="nx">id</span> <span class="nx">bigint</span> <span class="nx">DEFAULT</span> <span class="nx">nextval</span><span class="p">(</span><span class="s1">&#39;public.statuscode_id_seq&#39;</span><span class="o">::</span><span class="nx">regclass</span><span class="p">),</span>
    <span class="nx">text_value</span> <span class="nx">text</span>
<span class="p">);</span>


<span class="nx">ALTER</span> <span class="nx">TABLE</span> <span class="kr">public</span><span class="p">.</span><span class="nx">statuscode</span> <span class="nx">OWNER</span> <span class="nx">TO</span> <span class="nx">postgres</span><span class="p">;</span>

<span class="o">--</span>
<span class="o">--</span> <span class="nx">Name</span><span class="o">:</span> <span class="nx">app_history_index</span><span class="p">;</span> <span class="nx">Type</span><span class="o">:</span> <span class="nx">INDEX</span><span class="p">;</span> <span class="nx">Schema</span><span class="o">:</span> <span class="kr">public</span><span class="p">;</span> <span class="nx">Owner</span><span class="o">:</span> <span class="nx">postgres</span>
<span class="o">--</span>

<span class="nx">CREATE</span> <span class="nx">UNIQUE</span> <span class="nx">INDEX</span> <span class="nx">app_history_index</span> <span class="nx">ON</span> <span class="kr">public</span><span class="p">.</span><span class="nx">app_history</span> <span class="nx">USING</span> <span class="nx">btree</span> <span class="p">(</span><span class="nx">text_value</span><span class="p">);</span>


<span class="o">--</span>
<span class="o">--</span> <span class="nx">Name</span><span class="o">:</span> <span class="nx">statuscode_id</span><span class="p">;</span> <span class="nx">Type</span><span class="o">:</span> <span class="nx">INDEX</span><span class="p">;</span> <span class="nx">Schema</span><span class="o">:</span> <span class="kr">public</span><span class="p">;</span> <span class="nx">Owner</span><span class="o">:</span> <span class="nx">postgres</span>
<span class="o">--</span>

<span class="nx">CREATE</span> <span class="nx">UNIQUE</span> <span class="nx">INDEX</span> <span class="nx">statuscode_id</span> <span class="nx">ON</span> <span class="kr">public</span><span class="p">.</span><span class="nx">statuscode</span> <span class="nx">USING</span> <span class="nx">btree</span> <span class="p">(</span><span class="nx">text_value</span><span class="p">);</span>


<span class="o">--</span>
<span class="o">--</span> <span class="nx">Name</span><span class="o">:</span> <span class="nx">SCHEMA</span> <span class="kr">public</span><span class="p">;</span> <span class="nx">Type</span><span class="o">:</span> <span class="nx">ACL</span><span class="p">;</span> <span class="nx">Schema</span><span class="o">:</span> <span class="o">-</span><span class="p">;</span> <span class="nx">Owner</span><span class="o">:</span> <span class="nx">postgres</span>
<span class="o">--</span>

<span class="nx">REVOKE</span> <span class="nx">ALL</span> <span class="nx">ON</span> <span class="nx">SCHEMA</span> <span class="kr">public</span> <span class="nx">FROM</span> <span class="nx">rdsadmin</span><span class="p">;</span>
<span class="nx">REVOKE</span> <span class="nx">ALL</span> <span class="nx">ON</span> <span class="nx">SCHEMA</span> <span class="kr">public</span> <span class="nx">FROM</span> <span class="nx">PUBLIC</span><span class="p">;</span>
<span class="nx">GRANT</span> <span class="nx">ALL</span> <span class="nx">ON</span> <span class="nx">SCHEMA</span> <span class="kr">public</span> <span class="nx">TO</span> <span class="nx">postgres</span><span class="p">;</span>
<span class="nx">GRANT</span> <span class="nx">ALL</span> <span class="nx">ON</span> <span class="nx">SCHEMA</span> <span class="kr">public</span> <span class="nx">TO</span> <span class="nx">PUBLIC</span><span class="p">;</span>


<span class="o">--</span>
<span class="o">--</span> <span class="nx">PostgreSQL</span> <span class="nx">database</span> <span class="nx">dump</span> <span class="nx">complete</span>
<span class="o">--</span>
</pre></div>


<h2 id="-t-tabletable">-t, --table=TABLE</h2>
<p>dump the named table(s) only</p>
    </div>
    <div id="footer">
      <span>
        <p>Copyright © 2020 Xu XueHua.
        Powered by <a href="http://simiki.org/" target="_blank">Simiki</a>.</p>
        <p>Site Generated 2020-12-12 14:54:32</p>
      </span>
    </div>

    
    
  </body>
</html>